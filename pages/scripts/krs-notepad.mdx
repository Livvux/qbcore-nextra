# KRS Notepad

User-friendly notepad script for players to take quick notes, create reminders, and manage information in-game with a clean, intuitive interface and persistent storage.

## Features

### üìù Core Functionality
- **Rich Text Editing**: Full-featured text editor with formatting options
- **Multiple Notes**: Create and manage unlimited notes per player
- **Auto-Save**: Automatic saving to prevent data loss
- **Search & Filter**: Find notes quickly with built-in search functionality
- **Categories**: Organize notes with custom categories and tags
- **Sharing**: Share notes with other players or groups

### üé® User Interface
- **Modern Design**: Clean, responsive interface built with modern web technologies
- **Dark/Light Modes**: Theme options for different preferences
- **Mobile-Friendly**: Works perfectly on mobile devices and tablets
- **Keyboard Shortcuts**: Quick access with customizable hotkeys
- **Drag & Drop**: Intuitive note organization

### üîß Advanced Features
- **Backup & Export**: Export notes for backup or sharing
- **Templates**: Pre-made note templates for common uses
- **Encryption**: Optional note encryption for sensitive information
- **Collaboration**: Real-time collaborative editing for shared notes
- **Version History**: Track changes and revert to previous versions

## Installation

### Quick Setup

1. **Download KRS Notepad**
   ```bash
   cd resources/[misc]
   git clone https://github.com/example/krs-notepad.git
   ```

2. **Database Setup**
   ```sql
   -- Create notes table
   CREATE TABLE IF NOT EXISTS `player_notes` (
     `id` int(11) NOT NULL AUTO_INCREMENT,
     `citizenid` varchar(50) NOT NULL,
     `title` varchar(200) NOT NULL,
     `content` longtext NOT NULL,
     `category` varchar(50) DEFAULT 'general',
     `tags` text DEFAULT NULL,
     `is_private` tinyint(1) DEFAULT 1,
     `shared_with` text DEFAULT NULL,
     `created_at` timestamp DEFAULT CURRENT_TIMESTAMP,
     `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
     PRIMARY KEY (`id`),
     KEY `citizenid` (`citizenid`),
     KEY `category` (`category`)
   );

   -- Create note shares table
   CREATE TABLE IF NOT EXISTS `note_shares` (
     `id` int(11) NOT NULL AUTO_INCREMENT,
     `note_id` int(11) NOT NULL,
     `shared_by` varchar(50) NOT NULL,
     `shared_with` varchar(50) NOT NULL,
     `permission` enum('read','write','admin') DEFAULT 'read',
     `created_at` timestamp DEFAULT CURRENT_TIMESTAMP,
     PRIMARY KEY (`id`),
     FOREIGN KEY (`note_id`) REFERENCES `player_notes`(`id`) ON DELETE CASCADE
   );

   -- Create note templates table
   CREATE TABLE IF NOT EXISTS `note_templates` (
     `id` int(11) NOT NULL AUTO_INCREMENT,
     `name` varchar(100) NOT NULL,
     `category` varchar(50) NOT NULL,
     `template_content` longtext NOT NULL,
     `is_public` tinyint(1) DEFAULT 0,
     `created_by` varchar(50) DEFAULT NULL,
     `created_at` timestamp DEFAULT CURRENT_TIMESTAMP,
     PRIMARY KEY (`id`)
   );
   ```

3. **Server Configuration**
   ```cfg
   # Add to server.cfg
   start krs-notepad
   
   # Optional: Set resource permissions
   add_ace resource.krs-notepad command.notepad allow
   ```

## Configuration

### Basic Configuration

```lua
Config = {}

-- General Settings
Config.Framework = 'qb-core'        -- 'qb-core', 'esx', 'standalone'
Config.Debug = false                -- Enable debug logging
Config.MaxNotes = 100               -- Maximum notes per player
Config.MaxNoteSize = 10000          -- Maximum characters per note

-- UI Settings
Config.UI = {
    theme = 'auto',                 -- 'light', 'dark', 'auto'
    fontSize = 'medium',            -- 'small', 'medium', 'large'
    fontFamily = 'Inter',           -- Font family name
    animations = true,              -- Enable UI animations
    sounds = true,                  -- Enable sound effects
    
    -- Default window settings
    defaultWidth = 600,
    defaultHeight = 400,
    minWidth = 400,
    minHeight = 300,
    maxWidth = 1200,
    maxHeight = 800
}

-- Feature Settings
Config.Features = {
    richTextEditor = true,          -- Enable rich text formatting
    categories = true,              -- Enable note categories
    tags = true,                    -- Enable note tagging
    search = true,                  -- Enable search functionality
    sharing = true,                 -- Enable note sharing
    templates = true,               -- Enable note templates
    backup = true,                  -- Enable backup/export
    collaboration = false,          -- Enable real-time collaboration
    encryption = false,             -- Enable note encryption
    versionHistory = false          -- Enable version history
}

-- Sharing Settings
Config.Sharing = {
    enabled = true,
    maxSharedUsers = 10,            -- Maximum users per shared note
    permissions = {
        'read',                     -- Can view note
        'write',                    -- Can edit note
        'admin'                     -- Can manage sharing
    },
    
    -- Job-based sharing
    jobSharing = {
        enabled = true,
        jobs = {
            'police',               -- Police can share with all police
            'ems',                  -- EMS can share with all EMS
            'lawyer'                -- Lawyers can share with all lawyers
        }
    }
}

-- Categories
Config.Categories = {
    {name = 'general', label = 'General', icon = 'fas fa-file-alt', color = '#6b7280'},
    {name = 'work', label = 'Work', icon = 'fas fa-briefcase', color = '#3b82f6'},
    {name = 'personal', label = 'Personal', icon = 'fas fa-user', color = '#10b981'},
    {name = 'reminders', label = 'Reminders', icon = 'fas fa-bell', color = '#f59e0b'},
    {name = 'contacts', label = 'Contacts', icon = 'fas fa-address-book', color = '#8b5cf6'},
    {name = 'ideas', label = 'Ideas', icon = 'fas fa-lightbulb', color = '#ef4444'},
    {name = 'meetings', label = 'Meetings', icon = 'fas fa-calendar', color = '#06b6d4'},
    {name = 'research', label = 'Research', icon = 'fas fa-search', color = '#84cc16'}
}
```

### Advanced Configuration

```lua
-- Templates Configuration
Config.Templates = {
    {
        name = 'Meeting Notes',
        category = 'meetings',
        content = [[
# Meeting Notes - {DATE}

**Attendees:**
- 

**Agenda:**
1. 
2. 
3. 

**Key Points:**
- 

**Action Items:**
- [ ] 
- [ ] 

**Next Meeting:**
Date: 
Time: 
Location: 
        ]]
    },
    
    {
        name = 'Contact Information',
        category = 'contacts',
        content = [[
# Contact: {CONTACT_NAME}

**Basic Information:**
- Name: 
- Phone: 
- Email: 
- Job: 
- Location: 

**Notes:**
- 

**Last Contact:**
Date: 
Method: 
Purpose: 
        ]]
    },
    
    {
        name = 'Investigation Report',
        category = 'work',
        content = [[
# Investigation Report - Case #{CASE_NUMBER}

**Case Details:**
- Date: {DATE}
- Time: {TIME}
- Location: 
- Investigating Officer: 

**Summary:**


**Evidence Collected:**
- 

**Witnesses:**
- 

**Suspects:**
- 

**Status:**
[ ] Open
[ ] Under Investigation  
[ ] Closed

**Notes:**

        ]]
    }
}

-- Keybind Settings
Config.Keybinds = {
    openNotepad = 'F6',             -- Open notepad
    quickNote = 'F7',               -- Quick note creation
    searchNotes = 'CTRL+F',         -- Search notes
    newNote = 'CTRL+N',             -- Create new note
    saveNote = 'CTRL+S',            -- Save current note
    deleteNote = 'DELETE'           -- Delete selected note
}
```

## Commands and Usage

### Player Commands

```lua
-- Basic Commands
/notepad                        -- Open notepad interface
/note                          -- Quick alias for notepad
/quicknote [text]              -- Create quick note
/newnote [title]               -- Create new note with title
/searchnotes [query]           -- Search notes

-- Note Management
/notes list                    -- List all notes
/notes show [id]               -- Show specific note
/notes delete [id]             -- Delete note
/notes share [id] [player]     -- Share note with player
/notes category [id] [category] -- Change note category

-- Template Commands
/notes template [name]         -- Create note from template
/notes templates               -- List available templates

-- Backup Commands
/notes export                  -- Export all notes
/notes backup                  -- Create backup file
/notes import [file]           -- Import notes from file
```

### Admin Commands

```lua
-- Administration
/notepadmin                    -- Open admin panel
/notepadmin reload             -- Reload configuration
/notepadmin stats              -- Show usage statistics

-- User Management
/notepadmin user [id]          -- View user notes
/notepadmin clear [id]         -- Clear user notes
/notepadmin limit [id] [limit] -- Set user note limit

-- Template Management
/notepadmin template add [name] -- Add global template
/notepadmin template remove [name] -- Remove template
/notepadmin template list      -- List all templates

-- System Management
/notepadmin backup             -- Backup all notes
/notepadmin cleanup            -- Clean up old notes
/notepadmin maintenance        -- Run maintenance tasks
```

## Usage Examples

### Creating and Managing Notes

```lua
-- Client-side note creation
RegisterCommand('quicknote', function(source, args)
    local content = table.concat(args, ' ')
    if content and content ~= '' then
        local noteData = {
            title = 'Quick Note - ' .. os.date('%Y-%m-%d %H:%M'),
            content = content,
            category = 'general',
            isPrivate = true
        }
        
        TriggerServerEvent('krs-notepad:server:createNote', noteData)
    else
        -- Open notepad interface for manual entry
        SendNUIMessage({
            action = 'openNotepad',
            data = { quickNote = true }
        })
        SetNuiFocus(true, true)
    end
end)

-- Server-side note creation
RegisterNetEvent('krs-notepad:server:createNote', function(noteData)
    local src = source
    local Player = QBCore.Functions.GetPlayer(src)
    if not Player then return end
    
    local citizenid = Player.PlayerData.citizenid
    
    -- Check note limit
    MySQL.single('SELECT COUNT(*) as count FROM player_notes WHERE citizenid = ?', {
        citizenid
    }, function(result)
        if result.count >= Config.MaxNotes then
            TriggerClientEvent('QBCore:Notify', src, 'You have reached the maximum number of notes (' .. Config.MaxNotes .. ')', 'error')
            return
        end
        
        -- Create note
        MySQL.insert('INSERT INTO player_notes (citizenid, title, content, category, is_private, created_at) VALUES (?, ?, ?, ?, ?, NOW())', {
            citizenid,
            noteData.title,
            noteData.content,
            noteData.category or 'general',
            noteData.isPrivate and 1 or 0
        }, function(noteId)
            TriggerClientEvent('QBCore:Notify', src, 'Note created successfully!', 'success')
            TriggerClientEvent('krs-notepad:client:noteCreated', src, noteId)
        end)
    end)
end)
```

### Note Sharing System

```lua
-- Share note with another player
RegisterNetEvent('krs-notepad:server:shareNote', function(noteId, targetCitizenId, permission)
    local src = source
    local Player = QBCore.Functions.GetPlayer(src)
    if not Player then return end
    
    local citizenid = Player.PlayerData.citizenid
    
    -- Verify note ownership
    MySQL.single('SELECT * FROM player_notes WHERE id = ? AND citizenid = ?', {
        noteId, citizenid
    }, function(note)
        if not note then
            TriggerClientEvent('QBCore:Notify', src, 'Note not found or access denied', 'error')
            return
        end
        
        -- Check if already shared
        MySQL.single('SELECT * FROM note_shares WHERE note_id = ? AND shared_with = ?', {
            noteId, targetCitizenId
        }, function(existingShare)
            if existingShare then
                -- Update existing share
                MySQL.update('UPDATE note_shares SET permission = ? WHERE id = ?', {
                    permission, existingShare.id
                })
            else
                -- Create new share
                MySQL.insert('INSERT INTO note_shares (note_id, shared_by, shared_with, permission, created_at) VALUES (?, ?, ?, ?, NOW())', {
                    noteId, citizenid, targetCitizenId, permission
                })
            end
            
            -- Notify both players
            TriggerClientEvent('QBCore:Notify', src, 'Note shared successfully!', 'success')
            
            local targetPlayer = QBCore.Functions.GetPlayerByCitizenId(targetCitizenId)
            if targetPlayer then
                TriggerClientEvent('QBCore:Notify', targetPlayer.PlayerData.source, 'A note has been shared with you!', 'info')
                TriggerClientEvent('krs-notepad:client:noteShared', targetPlayer.PlayerData.source, noteId)
            end
        end)
    end)
end)

-- Get shared notes
QBCore.Functions.CreateCallback('krs-notepad:server:getSharedNotes', function(source, cb)
    local Player = QBCore.Functions.GetPlayer(source)
    if not Player then cb({}) return end
    
    local citizenid = Player.PlayerData.citizenid
    
    MySQL.query([[
        SELECT n.*, ns.permission, p.charinfo
        FROM player_notes n
        JOIN note_shares ns ON n.id = ns.note_id
        JOIN players p ON n.citizenid = p.citizenid
        WHERE ns.shared_with = ?
        ORDER BY n.updated_at DESC
    ]], {citizenid}, function(sharedNotes)
        for _, note in pairs(sharedNotes) do
            local charinfo = json.decode(note.charinfo)
            note.owner_name = charinfo.firstname .. ' ' .. charinfo.lastname
            note.charinfo = nil -- Remove sensitive data
        end
        cb(sharedNotes)
    end)
end)
```

### Template System

```lua
-- Client-side template usage
RegisterNUICallback('useTemplate', function(data, cb)
    local templateId = data.templateId
    local customVars = data.variables or {}
    
    QBCore.Functions.TriggerCallback('krs-notepad:server:getTemplate', function(template)
        if template then
            -- Replace template variables
            local content = template.template_content
            
            -- Default variables
            content = content:gsub('{DATE}', os.date('%Y-%m-%d'))
            content = content:gsub('{TIME}', os.date('%H:%M'))
            content = content:gsub('{DATETIME}', os.date('%Y-%m-%d %H:%M:%S'))
            
            -- Custom variables
            for key, value in pairs(customVars) do
                content = content:gsub('{' .. key:upper() .. '}', value)
            end
            
            cb({
                success = true,
                content = content,
                category = template.category
            })
        else
            cb({success = false, message = 'Template not found'})
        end
    end, templateId)
end)

-- Server-side template retrieval
QBCore.Functions.CreateCallback('krs-notepad:server:getTemplate', function(source, cb, templateId)
    MySQL.single('SELECT * FROM note_templates WHERE id = ? OR name = ?', {
        templateId, templateId
    }, function(template)
        cb(template)
    end)
end)
```

## API Reference

### Client Exports

```lua
-- Open notepad
exports['krs-notepad']:OpenNotepad()

-- Create quick note
exports['krs-notepad']:CreateQuickNote(content, category)

-- Get player notes
exports['krs-notepad']:GetNotes()

-- Search notes
exports['krs-notepad']:SearchNotes(query)

-- Check if notepad is open
local isOpen = exports['krs-notepad']:IsNotepadOpen()
```

### Server Exports

```lua
-- Create note for player
exports['krs-notepad']:CreateNote(citizenid, noteData)

-- Get player notes
local notes = exports['krs-notepad']:GetPlayerNotes(citizenid)

-- Share note
exports['krs-notepad']:ShareNote(noteId, sharedWith, permission)

-- Delete note
exports['krs-notepad']:DeleteNote(noteId, citizenid)

-- Create template
exports['krs-notepad']:CreateTemplate(templateData)
```

### Events

```lua
-- Client Events
AddEventHandler('krs-notepad:noteCreated', function(noteId)
    -- Handle note creation
end)

AddEventHandler('krs-notepad:noteUpdated', function(noteId)
    -- Handle note update
end)

AddEventHandler('krs-notepad:noteShared', function(noteId)
    -- Handle note sharing
end)

-- Server Events
AddEventHandler('krs-notepad:server:noteCreated', function(citizenid, noteId)
    -- Server-side note creation handling
end)
```

---

**Organize your thoughts and information!** KRS Notepad provides a comprehensive note-taking solution that enhances roleplay by helping players keep track of important information and collaborate effectively.

Check out our other [script options](/scripts) or get [support](/support) for customization help.